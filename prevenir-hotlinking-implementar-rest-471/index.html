<!doctype html><html lang=es-es><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=twitter:card content="summary"><meta name=twitter:title content="Prevenir el hotlinking e implementar REST"><meta name=twitter:description content><meta name=twitter:site content="@obokaman"><meta property="og:title" content="Prevenir el hotlinking e implementar REST &#183; Albert García Gibert"><meta property="og:site_name" content="Albert García Gibert"><meta property="og:url" content="https://albert.garcia.gibert.es/prevenir-hotlinking-implementar-rest-471/"><meta property="og:image" content="https://albert.garcia.gibert.es/images/background-202006041954.jpg"><meta property="og:description" content><meta property="og:type" content="article"><meta property="article:published_time" content="2005-01-10T17:58:42Z"><meta property="article:tag" content="desarrollo web"><title>Prevenir el hotlinking e implementar REST &#183; Albert García Gibert</title><meta name=description content="Nuevas características en el obokaman.com. Muy posiblemente las hayas pasado por alto, y por eso mismo las comento aquí, por si te son de utilidad en algún mome"><meta name=HandheldFriendly content="True"><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://albert.garcia.gibert.es/images/favicon.ico><link rel=apple-touch-icon href=https://albert.garcia.gibert.es/images/apple-touch-icon.png><link rel=stylesheet type=text/css href=https://albert.garcia.gibert.es/css/screen.css?v2><link rel=stylesheet type=text/css href=https://albert.garcia.gibert.es/css/nav.css?v2><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/styles/default.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link href=https://albert.garcia.gibert.es/index.xml rel=alternate type=application/rss+xml title="Albert García Gibert"><meta name=generator content="Hugo 0.72.0"><link rel=canonical href=https://albert.garcia.gibert.es/prevenir-hotlinking-implementar-rest-471/><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","publisher":{"@type":"Organization","name":null,"logo":"https://albert.garcia.gibert.es/favicon.ico"},"author":{"@type":"Person","name":null,"image":{"@type":"ImageObject","url":"https://albert.garcia.gibert.es/favicon.ico","width":250,"height":250},"url":"https://albert.garcia.gibert.es","sameAs":[],"description":"Cofounder and former CTO of @Uvinum, founder of @Obolog. Father of @soclajulia \u0026 @soclabril . I'd like to travel more and improve my guitar skills."},"headline":"Prevenir el hotlinking e implementar REST","name":"Prevenir el hotlinking e implementar REST","wordCount":530,"timeRequired":"PT3M","inLanguage":{"@type":"Language","alternateName":"en"},"url":"https://albert.garcia.gibert.es/prevenir-hotlinking-implementar-rest-471/","datePublished":"2005-01-10T17:58Z","dateModified":"2005-01-10T17:58Z","keywords":"desarrollo web","description":"","mainEntityOfPage":{"@type":"WebPage","@id":"https://albert.garcia.gibert.es/prevenir-hotlinking-implementar-rest-471/"}}</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-97247-14','auto');ga('send','pageview');</script><link rel=preload href=https://albert.garcia.gibert.es/fonts/Open_Sans/OpenSans-Regular.ttf as=font type=font/ttf crossorigin><link rel=preload href=https://albert.garcia.gibert.es/fonts/Open_Sans/OpenSans-Bold.ttf as=font type=font/ttf crossorigin><link rel=preload href=https://albert.garcia.gibert.es/fonts/Merriweather/Merriweather-Light.ttf as=font type=font/ttf crossorigin><link rel=preload href=https://albert.garcia.gibert.es/fonts/Merriweather/Merriweather-LightItalic.ttf as=font type=font/ttf crossorigin><link rel=preload href=https://albert.garcia.gibert.es/fonts/Merriweather/Merriweather-Bold.ttf as=font type=font/ttf crossorigin><link rel=preload href=https://albert.garcia.gibert.es/fonts/Merriweather/Merriweather-BoldItalic.ttf as=font type=font/ttf crossorigin><link rel=preload href=https://albert.garcia.gibert.es/fonts/Inconsolata/Inconsolata-Regular.ttf as=font type=font/ttf crossorigin><link rel=preload href=https://albert.garcia.gibert.es/fonts/Genericons/Genericons.woff as=font type=font/woff crossorigin></head><body class=nav-closed><div class=nav><h3 class=nav-title>Menu</h3><a href=# class=nav-close title=Cerrar><span class=hidden>Cerrar</span></a><ul></ul><a class="subscribe-button icon-feed" href=https://albert.garcia.gibert.es/index.xml>Suscríbete</a></div><span class=nav-cover></span><div class=site-wrapper><header class="main-header post-head no-cover"><nav class="main-nav clearfix"><a class=blog-logo href=https://albert.garcia.gibert.es/><img src=https://albert.garcia.gibert.es/favicon.ico alt=Home></a>
<a class="menu-button icon-feed" href=https://albert.garcia.gibert.es/index.xml>&nbsp;&nbsp;Suscríbete</a></nav></header><main class=content role=main><article class="post post-template post"><header class=post-header><h1 class=post-title>Prevenir el hotlinking e implementar REST</h1><small></small><section class=post-meta><time class=post-date datetime=2005-01-10T17:58:42Z>10 enero 2005</time>
<span class="enumeration post-tag small"><a href=https://albert.garcia.gibert.es/tags/desarrollo-web/>#desarrollo web</a></span></section></header><section class=post-content><p>Nuevas características en el obokaman.com. Muy posiblemente las hayas pasado por alto, y por eso mismo las comento aquí, por si te son de utilidad en algún momento. Se trata de dos soluciones concretas que tienen que ver con el fichero de configuración .htaccess y el mod rewrite para Apache, que permite que el servidor web "reescriba" una URL que recibe.</p><p>En primer lugar, este último mes he visto que estamos llegando al límite de transferencia del hosting de obokaman.com, 4Gb al mes. Esto ha venido dado por diversas circunstancias, como algunas fotos tituladas "maremoto" en la galería, que han provocado un aluvión de visitas desde Google Images, y el hecho que diversas páginas externas enlazan directamente con imágenes de obokaman.com (algo conocido como <em>hotlinking</em> o <em>robo de ancho de banda</em>), provocando que se descarguen de este servidor cada vez que alguien visita su web. Feo. Aunque supongo que la mayoría de las veces se hace por desconocimiento. Sea como sea, antes de plantearme eliminar alguna sección de la web para reducir tráfico, prefiero plantearme alguna opción menos bestia. He optado por bloquear el acceso a las imágenes de obokaman.com desde el exterior. A partir de ahora, cuando alguien muestre una imagen de obokaman.com en su server, aparecerá este gif.</p><div align=center><p><img src=https://albert.garcia.gibert.es/nohotlink.gif width=200 height=150></p></div><p>Esto es sencillo de conseguir modificando o creando un fichero llamado ".htaccess" en la carpeta raíz, con el siguiente contenido:</p><pre class=codigo>RewriteEngine On
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://(www\.)?obokaman\.com/ [NC]
RewriteCond %{HTTP_REFERER} !^http://(www\.)?internostrum\.com/ [NC]
RewriteCond %{HTTP_REFERER} !^http://(www\.)?bloglines\.com/ [NC]
RewriteCond %{HTTP_REFERER} !^http://(www\.)?feedness\.com/ [NC]
RewriteRule \.(jpe?g|gif|bmp|png)$ nohotlink.gif [L]</pre><p>Como ves, las líneas donde aparece "RewriteCond", son en las que se especifica qué servidores son los "autorizados". En mi caso he activado dos lectores de noticias y la página que permite hacer las traducciones de catalán a castellano. Al final, RewriteRule, le dice qué hacer cuando se cumplan las condiciones _redireccionar a la imagen nohotlink.gif_. Tu puedes cambiar esas lineas para adaptarlo a tus necesidades.</p><p>El segundo tema que queria tratar de instaurar en obokaman.com era referente a las URL "amigables", esto es, intentar evitar las direcciones del tipo "indice_msg.php?blog=colectivo&categoria=Internet", que resultan ininteligibles en muchos casos y cambiarlo por algo del tipo "/archivos/colectivo/internet". De la misma manera, a partir de ahora para acceder a los mensajes lo haremos usando la url www.obokaman.com/mensaje/id_del_mensaje, para acceder al blog de cada uno, lo haremos escribiendo www.obokaman.com/blog/nombre_de_usuario., etc... Aunque las URL así lo indiquen, no hay ninguna carpeta en la web que se llame "blog" ni "archivos" ni "mensaje". De traducir esas URL a las correctas se encarga de nuevo el mod rewrite de Apache. Estas son las lineas que convierten las URL en el caso de obokaman.com</p><pre class=codigo>RewriteEngine On
  RewriteRule ^(.*)mensaje/(.*)/?$ /mensaje/$2 [QSA]
  RewriteRule ^(.*)archivos/(.*)/(.*)?/?$ /indice_msg.php?blog=$2&categoria=$3 [L]
  RewriteRule ^(.*)archivos/(.*)/?$ /indice_msg.php?blog=$2&categoria=$3 [L]
  RewriteRule ^(.*)archivos/?$ /indice_msg.php [QSA]
  RewriteRule ^(.*)buscar/?$ /buscar.php [QSA]
  RewriteRule ^(.*)blog/(.*)/?$ /index.php?blog=$2 [QSA]</pre><p>RewriteRule le especifica mediante expresiones regulares, la cadena modelo y la URL real a la que se debe redireccionar en cada caso. Lo de las expresiones regulares tiene candela. Si quieres empaparte con su sintaxis te recomiendo <a href=http://www.regular-expressions.info/reference.html target=_blank>esta web</a> como referencia.</p><p>Bueno, y eso es todo. Como ves, nada que afecte en apariencia al funcionamiento normal de la web, pero que mejora su rendimiento.</p></section><footer class=post-footer><figure class=author-image><a class=img href=https://albert.garcia.gibert.es/ style=background-image:url(/images/avatar.jpg)><span class=hidden>Foto de Albert García Gibert</span></a></figure><section class=author><h4><a href=https://albert.garcia.gibert.es/>Albert García Gibert</a></h4><p>Cofounder and former CTO of @Uvinum, founder of @Obolog. Father of @soclajulia & @soclabril . I'd like to travel more and improve my guitar skills.</p><div class=author-meta><span class="author-location icon-location">El Prat de Llobregat, Barcelona</span>
<span class="author-link icon-link"><a href=https://albert.garcia.gibert.es>https://albert.garcia.gibert.es</a></span></div></section><section class=share><h4>Compartir post</h4><a class=icon-twitter style=font-size:1.4em href="https://twitter.com/share?text=Prevenir%20el%20hotlinking%20e%20implementar%20REST&nbsp;-&nbsp;Albert%20Garc%c3%ada%20Gibert&url=https%3a%2f%2falbert.garcia.gibert.es%2fprevenir-hotlinking-implementar-rest-471%2f" onclick="window.open(this.href,'twitter-share','width=550,height=235');return false;"><span class=hidden>Twitter</span></a>
<a class=icon-facebook style=font-size:1.4em href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2falbert.garcia.gibert.es%2fprevenir-hotlinking-implementar-rest-471%2f" onclick="window.open(this.href,'facebook-share','width=580,height=296');return false;"><span class=hidden>Facebook</span></a>
<a class=icon-pinterest style=font-size:1.4em href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2falbert.garcia.gibert.es%2fprevenir-hotlinking-implementar-rest-471%2f&description=Prevenir%20el%20hotlinking%20e%20implementar%20REST" onclick="window.open(this.href,'pinterest-share','width=580,height=296');return false;"><span class=hidden>Pinterest</span></a></section><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https:\/\/albert.garcia.gibert.es\/prevenir-hotlinking-implementar-rest-471\/";this.page.identifier="https:\/\/albert.garcia.gibert.es\/prevenir-hotlinking-implementar-rest-471\/";};(function(){var d=document,s=d.createElement('script');s.src='https://albert-garcia-gibert.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></footer></article></main><aside class=read-next><a class=read-next-story style=no-cover href=https://albert.garcia.gibert.es/indignacion-474/><section class=post><h2>Indignación</h2></section></a><a class="read-next-story prev" style=no-cover href=https://albert.garcia.gibert.es/abadia-crimen-470/><section class=post><h2>La Abadia del Crimen</h2></section></a></aside><footer class="site-footer clearfix"><section class=copyright><a href=https://albert.garcia.gibert.es/>Albert García Gibert</a></section><section class=poweredby>Generado con <a class=icon-hugo href=http://gohugo.io>HUGO</a>, con el tema <a class=icon-theme href=https://github.com/vjeantet/hugo-theme-casper>Casper</a></section></footer></div><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script type=text/javascript src=https://albert.garcia.gibert.es/js/jquery.fitvids.js></script><script type=text/javascript src=https://albert.garcia.gibert.es/js/index.js></script></body></html>